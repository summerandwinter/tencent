# Xh 和 Zh 函数分析

## Xh 函数（31848-31862行）

### 功能
生成基础的 cKey 信息，用于视频播放的基础验证。

### 参数
- `e`：配置对象，包含以下属性：
  - `svrtick`：视频服务时间戳，若大于0则使用它生成时间
  - `platform`：平台标识
  - `ckeyid`：密钥ID
  - `sdtfrom`：来源标识

### 实现逻辑
1. 获取当前星期几，生成加密版本号 `7.x`（x为星期几，星期日为7）
2. 生成时间戳：优先使用 `svrtick`，否则调用 `Nd()` 获取当前时间戳
3. 调用 `JB.$xx()` 方法生成基础 cKey
4. 返回包含时间戳、cKey 和加密版本的对象

### 返回值
```javascript
{
  tm: string,     // 时间戳
  cKey: string,   // 生成的cKey
  encryptVer: string  // 加密版本（如 "7.1" 表示周一）
}
```

## Zh 函数（31873-31948行）

### 功能
生成加密的 cKey 信息，用于更高级别的视频播放验证，采用 AES 加密。

### 参数
- `t`：配置对象，包含以下属性：
  - `vid`：视频ID
  - `updateTimeStamp`：更新时间戳
  - `appVer`：应用版本
  - `guid`：设备GUID
  - `platform`：平台标识
  - `h38`：额外的设备或用户信息

### 实现逻辑
1. 准备视频ID、时间戳、应用版本等参数
2. 生成11位随机字符串作为 nonce
3. 构建包含视频ID、SDK版本、nonce、随机数、应用版本、设备GUID等信息的数据对象
4. 配置 AES 加密参数：
   - 固定 IV：`CFAC216FAA2D396013575D4055C63350`
   - 固定密钥：`2A5AA60178AA6C8DA662E443773A6C4E`
   - 加密模式和填充方式（由 `mh` 和 `Qh` 指定）
5. 使用 AES 加密数据对象并格式化结果

### 返回值
```javascript
{
  tm: string,     // 时间戳
  cKey: string,   // 加密的cKey（格式："--01" + 大写密文）
  encryptVer: string  // 加密版本（CKEY_8）
}
```

## 关键技术点

1. **加密机制**：
   - Xh 函数使用简单的 `JB.$xx()` 方法生成基础 cKey
   - Zh 函数使用 AES 加密生成更安全的 cKey

2. **版本控制**：
   - Xh 函数的版本号与星期几相关，每天自动变化
   - Zh 函数使用固定的 CKEY_8 版本

3. **随机数生成**：
   - Zh 函数生成11位随机 nonce
   - 基于 nonce 生成8位随机数用于加密数据

4. **时间戳处理**：
   - 支持使用服务端提供的时间戳或客户端当前时间
   - 确保加密数据的时效性

这些函数是 Tencent SuperPlayer 视频播放验证机制的重要组成部分，用于生成不同级别的 cKey 以确保视频播放的安全性和合法性。